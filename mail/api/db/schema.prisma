datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

model User {
  id                  Int           @id @default(autoincrement())
  email               String        @unique
  hashedPassword      String // <─┐
  salt                String // <─┼─ add these lines
  resetToken          String? // <─┤
  resetTokenExpiresAt DateTime? // <─┘
  joined              DateTime      @default(now())
  prefrences          Prefrence[]
  mailingLists        MailingList[]
  emails              Email[]
  Method              Method?       @relation(fields: [methodId], references: [id])
  methodId            Int?
}

model Prefrence {
  id          Int     @id @default(autoincrement())
  marketing   Boolean
  dawah       Boolean
  promotional Boolean
  news        Boolean
  User        User?   @relation(fields: [userId], references: [id])
  userId      Int?
}

model Method {
  id     Int     @id @default(autoincrement())
  email  Boolean
  phone  Boolean
  postal Boolean
  users  User[]
}

model MailingList {
  id             Int             @id @default(autoincrement())
  name           String          @unique
  description    String?
  subscribers    User[]
  emailCampaigns EmailCampaign[]
  Email          Email?          @relation(fields: [emailId], references: [id])
  emailId        Int?
}

model EmailCampaign {
  id            Int         @id @default(autoincrement())
  name          String      @unique
  description   String?
  mailingList   MailingList @relation(fields: [mailingListId], references: [id])
  emails        Email[]
  mailingListId Int
}

model Email {
  id             Int             @id @default(autoincrement())
  subject        String
  content        String
  sentAt         DateTime
  sender         String
  recipients     User[]
  mailingLists   MailingList[]
  emailCampaigns EmailCampaign[]
}
